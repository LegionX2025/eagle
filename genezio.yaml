backend:
  functions:
    - entry: app.mjs
      handler: handler
      name: express-mongo-starter
      path: ./
      type: httpServer
  language:
    name: js
    packageManager: npm
  path: ./
  scripts:
    deploy: |
      npm install    # Only install dependencies, no build step
    local: |
      npm install
      npm run dev    # Start in development mode
  environment:
    DATABASE_URL: ${{ databases.mongodarknet.url }}  # Use MongoDB URL for backend
  subdomain: eagle

frontend:
  environment:
    VITE_API_URL: ${{ backend.functions.express-mongo-starter.url }}  # Ensure this URL is correct
  path: ./frontend
  publish: ./dist
  scripts:
    build: npm run build    # Ensure this is correct if you have frontend build steps
    deploy: npm install
    start: npm run dev      # Start frontend server
  subdomain: eagle

name: eagle
region: us-east-1

services:
  databases:
    - name: my-mongo-db
      region: us-east-1
      type: mongo-atlas
    - name: mongodarknet  # MongoDB for the backend
      region: us-east-1
      type: mongo-atlas

yamlVersion: 2
